{% macro proc_report(procs) -%}
{# args:
    procs (list[dict]) - analysis_driver_procs from the Rest API.
#}

<div id="analysis_driver_proc_tabs">
    <h2>Analysis Driver processes</h2>
    <p>Number of times processed: {{ procs|length }}</p>
    <ol>
        {% for proc in procs %}
        <li><a href="#{{ proc.proc_id }}_tab"><span>{{ proc._created }}</span></a></li>
        {% endfor %}
    </ol>
    {% for proc in procs %}
    <div id="{{ proc.proc_id }}_tab">
        <br/>
        <ul>
            <li>Started: {{ proc._created }}</li>
            <li>Ended:
                {% if proc.end_date %}
                {{ proc.end_date }}
                {% else %}
                running with pid: {{ proc.pid }}
                {% endif %}
            </li>
            <li>
                Status:
                {% if proc.status %}
                {{ proc.status }}
                {% else %}
                inactive
                {% endif %}
            </li>
            <li>
                Stages: <ul>
                {% for s in proc.stages %}
                <li>
                    <b>{{ s.stage_name }}</b>{% if not s.date_finished %} (running) {% endif %}<br/>
                    started: {{ s.date_started }}<br/>
                    {% if s.date_finished %}
                    finished: {{ s.date_finished }}
                    {% endif %}
                </li>
                {% endfor %}
                </ul>
            </li>
        </ul>
    </div>
    {% endfor %}
</div>

<script>
   $("#analysis_driver_proc_tabs").tabs();
</script>

{%- endmacro %}
